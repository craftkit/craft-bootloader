window.CraftBootloader=function(e){var t={};function o(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";const n=o(1);document.addEventListener("DOMContentLoaded",n.default.main),e.exports=n.default||n},function(e,t,o){"use strict";o.r(t);class n{constructor(e,t){this.lib=e,this.delegate=t}prepareFromCache(){window.bootConfig.Context.libStore.get(this.lib.uri,e=>{this.lib.content=e,this.delegate.checker(this.lib)})}prepareFromRemote(){let e=new XMLHttpRequest;e.onload=(t=>{this.lib.content=e.responseText,window.bootConfig.Context.libStore.put(this.lib.uri,this.lib.content,()=>{window.bootConfig.Context.verStore.put(this.lib.uri,this.lib.version,()=>{this.delegate.checker(this.lib)})})}),e.onerror=(e=>{alert("Cannot load")}),e.ontimeout=(()=>{alert("Timeout")}),e.open("GET",this.lib.uri),e.send()}prepare(){window.bootConfig.Context.verStore.get(this.lib.uri,e=>{this.lib.version!==e?this.prepareFromRemote():this.prepareFromCache()})}load(){}}class i extends n{load(){let e=document.createElement("script");e.type="text/javascript",e.text=this.lib.content,e.async=!1,document.head.appendChild(e)}}class a extends n{load(){let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText=this.lib.content:t.appendChild(document.createTextNode(this.lib.content)),e.appendChild(t)}}class r{constructor(e,t){this.db=e,this.name=t}put(e,t,o){this.db.connect(n=>{n.transaction(this.name,"readwrite").objectStore(this.name).put(t,e).onsuccess=(()=>{o&&o()})})}get(e,t){this.db.connect(o=>{let n=o.transaction(this.name,"readonly").objectStore(this.name).get(e);n.onsuccess=(e=>{let o=n.result;t&&t(o)})})}del(e,t){this.db.connect(o=>{o.transaction(this.name,"readwrite").objectStore(this.name).delete(e).onsuccess=(()=>{t&&t()})})}keys(e){this.db.connect(t=>{let o=t.transaction(this.name,"readonly").objectStore(this.name).getAllKeys();o.onsuccess=(t=>{let n=o.result;e&&e(n)})})}}const s={LibLoader:class{constructor(e){this.libs=window.bootConfig.library,this.loadFlags={},this.libs.map(e=>{this.loadFlags[e.uri]=!1})}clearUnusedLibs(e){window.bootConfig.Context.verStore.keys(e=>{e.map(e=>{window.bootConfig.Context.libMap[e]||(window.bootConfig.Context.verStore.del(e),window.bootConfig.Context.libStore.del(e))})})}load(){if(this.libs.length<1)return window.bootConfig.onLibrayLoaded();this.libs.map(e=>{e.uri.match(/\.js$/)?(e.loader=new i(e,this),e.loader.prepare()):url.url.match(/\.css$/)&&(e.loader=new a(e,this),e.loader.prepare())}),this.clearUnusedLibs()}checker(e){this.loadFlags[e.uri]=!0;let t=!0;window.bootConfig.onProgress&&window.bootConfig.onProgress(e);let o=Object.keys(this.loadFlags);for(let e=0;e<o.length;e++)if(!this.loadFlags[o[e]]){t=!1;break}t&&(this.libs.map(e=>{e.loader.load()}),window.bootConfig.onLibrayLoaded())}},ResourceLoader:n,JavaScriptLoader:i,StyleSheetLoader:a,Database:class{constructor(e,t){this.name=e,this.version=t||1,this.instance=""}connect(e){let t=indexedDB.open(this.name,this.version);t.onupgradeneeded=(e=>{console.log("idb upgrade needed"),this.instance=t.result,this.instance.createObjectStore(window.bootConfig.database.lib_store_name),this.instance.createObjectStore(window.bootConfig.database.ver_store_name)}),t.onerror=(()=>{console.log("idb connection error"),e()}),t.onsuccess=(()=>{this.instance||(this.instance=t.result),this.setupStore(),e(this.instance)})}setupStore(){window.bootConfig.Context.libStore=new r(this,window.bootConfig.database.lib_store_name),window.bootConfig.Context.verStore=new r(this,window.bootConfig.database.ver_store_name)}disconnect(){this.instance.close()}},ObjectStore:r,usePackage:function(e){e.inject(s)},main:function(){window.bootConfig.database||(window.bootConfig.database={}),window.bootConfig.database.indexeddb_name=window.bootConfig.database.indexeddb_name||"CraftBootloader_database_indexeddb",window.bootConfig.database.lib_store_name=window.bootConfig.database.lib_store_name||"CraftBootloader_database_libStore",window.bootConfig.database.ver_store_name=window.bootConfig.database.ver_store_name||"CraftBootloader_database_verStore",window.bootConfig.Context={libMap:{},database:new s.Database,libStore:"",verStore:""},window.bootConfig.library.map(e=>{window.bootConfig.Context.libMap[e.uri]=1}),window.bootConfig.Context.database.connect(()=>{(new s.LibLoader).load()})}};t.default=s}]);